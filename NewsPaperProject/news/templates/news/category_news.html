<!-- news/templates/news/category_news.html -->
{% extends 'news/default.html' %}
{% load auth_extras %}

{% block content %}
<div class="category-news">
    <div style="background-color: #e9ecef; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
        <h1 style="margin-top: 0;">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ category.name }}</h1>

        {% if user.is_authenticated %}
            <div style="margin-top: 15px;">
                {% if is_subscribed %}
                    <span style="color: #28a745; margin-right: 15px;">
                        ‚úì –í—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                    </span>
                    <a href="{% url 'unsubscribe' category.id %}"
                       class="btn btn-secondary"
                       style="padding: 8px 15px; background-color: #6c757d; color: white; text-decoration: none; border-radius: 5px;">
                        –û—Ç–ø–∏—Å–∞—Ç—å—Å—è
                    </a>
                {% else %}
                    <a href="{% url 'subscribe' category.id %}"
                       class="btn btn-success"
                       style="padding: 8px 15px; background-color: #28a745; color: white; text-decoration: none; border-radius: 5px;">
                        üì® –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
                    </a>
                {% endif %}
            </div>
        {% else %}
            <p style="color: #666;">
                <a href="{% url 'account_login' %}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            </p>
        {% endif %}

        <p style="margin-top: 15px; color: #666;">
            –ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: {{ category.subscribers.count }}
        </p>
    </div>

    {% if news_list %}
        <h2>–ù–æ–≤–æ—Å—Ç–∏ –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ({{ news_list.count }})</h2>

        {% for news in news_list %}
        <div class="news-item">
            <!-- –¢–æ—Ç –∂–µ –∫–æ–¥, —á—Ç–æ –∏ –≤ news_list.html -->
            <h3><a href="{% url 'news_detail' news.id %}">{{ news.title }}</a></h3>
            <!-- ... -->
        </div>
        {% endfor %}
    {% else %}
        <div class="alert alert-info" style="padding: 30px; text-align: center;">
            <h3>–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç –Ω–æ–≤–æ—Å—Ç–µ–π</h3>
            <p>–ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –¥–æ–±–∞–≤–∏—Ç –Ω–æ–≤–æ—Å—Ç—å!</p>
            {% if user.is_authenticated and user|has_group:'authors' %}
                <a href="{% url 'news_create' %}" class="btn btn-primary">
                    –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å
                </a>
            {% endif %}
        </div>
    {% endif %}
</div>
{% endblock %}