{% extends 'news/default.html' %}
{% load auth_extras %}

{% block content %}
<div class="news-list">
    {% for news in news_list %}
    <div class="news-item">
        <h3><a href="{% url 'news_detail' news.id %}">{{ news.title }}</a></h3>
        <p>{{ news.text|truncatewords:30 }}</p>
        <small>
            Автор: {{ news.author.username }} |
            Дата: {{ news.created_at|date:"d.m.Y H:i" }} |
            Тип: {{ news.get_post_type_display }}
        </small>

        <!-- Показываем кнопки редактирования/удаления только автору -->
        {% if user.is_authenticated and user == news.author and user|has_group:'authors' %}
        <div class="news-actions">
            <a href="{% url 'news_edit' news.id %}" class="btn btn-sm btn-primary">Редактировать</a>
            <a href="{% url 'news_delete' news.id %}" class="btn btn-sm btn-danger">Удалить</a>
        </div>
        {% endif %}
    </div>
    {% empty %}
    <p>Новостей пока нет.</p>
    {% endfor %}
</div>

<!-- Кнопка создания новости показывается только авторам -->
{% if user.is_authenticated and user|has_group:'authors' %}
<div style="margin-top: 20px;">
    <a href="{% url 'news_create' %}" class="btn btn-success">Создать новость</a>
    <a href="{% url 'article_create' %}" class="btn btn-info">Создать статью</a>
</div>
{% endif %}
{% endblock %}